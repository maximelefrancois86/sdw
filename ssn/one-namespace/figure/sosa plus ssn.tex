\documentclass{article}

\usepackage{tikz}
\usepackage[utf8]{inputenc}
\usepackage[T3,T1]{fontenc}


\usepackage{fancyhdr}
\usepackage{lastpage}

% Style packages
\usepackage{helvet}
\usepackage{pifont}
\usepackage{amsmath,amsfonts,mathabx,stmaryrd}
\usepackage{color,xcolor}
\usepackage{calculator}
\DeclareUnicodeCharacter{20AC}{\euro}
\usepackage{url}
\usepackage{xspace}

\usepackage[active,tightpage]{preview}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{5pt}%
\usetikzlibrary{trees}
\newcommand{\why}{{\color{red} ???}}


\begin{tikzpicture}[
  ssn/.style={color=black!60!green},
  ssnr/.style={color=black!60!green},
  ssnl/.style={scale=0.8,color=black!60!green},
  sosa/.style={color=black!60!blue},
  sosar/.style={color=black!60!blue},
  sosal/.style={scale=0.8,color=black!60!blue},
  first/.style={level distance=6ex},
  second/.style={level distance=12ex},
  third/.style={level distance=18ex},
  level 1/.style={sibling distance=5em}]

  % ProcedureExecution
  \draw[style=dotted] (-2,-1) rectangle (2,1);
  \node[sosa] (Actuation) at (0,.5) {sosa:Actuation} ;
  \node[sosa] (Observation) at (0,-.5) {sosa:Observation} ;

  % ProcedureExecutor
  \draw[style=dotted] (6,-1) rectangle (10,1);
  \node[sosa] (Actuator) at (8,.5) {sosa:Actuator} ;
  \node[sosa] (Sensor) at (8,-.5) {sosa:Sensor} ;

  % ProcedureExecution to ProcedureExecutor
  \draw[sosar] (Actuation) to[bend left=3]
    node[sosal,below] {$\blacktriangleleft$ sosa:invokes }
    node[sosal,above] {sosa:invokedBy $\blacktriangleright$}
  (Actuator);

  \draw[sosar] (Observation) to[bend right=3]
    node[sosal,below] {$\blacktriangleleft$ sosa:madeObservation }
    node[sosal,above] {\why $\blacktriangleright$}
  (Sensor);

  % Procedure
  \node[sosa] (Procedure) at (4,4) {sosa:Procedure} ;

  % ProcedureExecution to Procedure
  \draw[sosar] (0,1) to[bend left=10]
    node[sosal,above,sloped] {sosa:usedProcedure $\blacktriangleright$}
  (Procedure);

  % ProcedureExecution to phenomenonTime
  \node[color=black] (Thing) at (-6,1.2) {owl:Thing} ;
  \draw[sosar] (-2,0.6) to[bend right=10]
    node[sosal,above,sloped] {$\blacktriangleleft$ sosa:phenomenonTime }
  (Thing);

  % ProcedureExecution to result
  \node[sosa] (Result) at (-6,-1) {ssn:Result} ;
  \draw[sosar] (-2,-0.6) to[bend left=10]
    node[sosal,below,sloped] {$\blacktriangleleft$ sosa:hasResult }
    node[sosal,above,sloped] {sosa:isResultOf $\blacktriangleright$ }
  (Result);


  % Result time and value
  \node[color=black] (Literal) at (-10,0) {rdfs:Literal} ;
  \draw[sosar] (Result) to[bend right=10]
    node[sosal,above,sloped] {$\blacktriangleleft$ sosa:resultTime }
  (Literal);

  \node[color=black] (Literal2) at (-10,-2) {rdfs:Literal} ;
  \draw[sosar] (Result) to[bend left=10]
    node[sosal,above,sloped] {$\blacktriangleleft$ sosa:hasValue }
  (Literal2);


  % Platform
  \node[color=black] (Platform) at (8,5) {sosa:Platform} ;
  \draw[sosar] (8,1) to
    node[sosal,right,pos=.4] {$\blacktriangledown$ sosa:hostedBy }
    node[sosal,right,pos=.6] {$\blacktriangleup$ sosa:hosts }
  (Platform);



  % FeatureOfInterest and Sample
  \draw[style=dotted] (-4,-8) rectangle (1,-5);
  \node[sosa,anchor=north west] (FeatureOfInterest) at (-4,-5.5) {sosa:FeatureOfInterest} ;
  \node[sosa,anchor=south east] (Sample) at (1,-8) {sosa:Sample} ;

  \draw[sosar] (FeatureOfInterest) to[bend right = 20]
    node[sosal,left,pos=0.35] { sosa:isSampleOf $\blacktriangledown$}
    node[sosal,left,pos=0.65] { sosa:hasSample $\blacktriangleup$}
  (Sample);


  \draw[sosar,bend right=2] (FeatureOfInterest) to[bend left=10]
    node[sosal,above,sloped] {sosa:isFeatureOfInterestOf $\blacktriangleright$}
  ($(Observation.south)+(-0.1,0)$) ;

  \draw[sosa,bend right=2] (-1.9,-5) to[bend left=10]
    node[sosal,below,sloped] {$\blacktriangleleft$ sosa:hasFeatureOfInterest}
  ($(Observation.south)+(0.1,0)$) ;

  % Observable Property
  \node[sosa,anchor=north west] (ObservableProperty) at (9.5,-5.5) {sosa:ObservableProperty} ;
  \draw[sosar] (Observation) to[bend right=10]
    node[sosal,below,sloped] {sosa:observedProperty $\blacktriangleright$}
    node[sosal,above,sloped] {\why}
  (ObservableProperty);

  \draw[sosar] (Sensor) to[bend right=10]
    node[sosal,left,pos=0.45] {sosa:isObservedBy $\blacktriangleup$}
    node[sosal,left,pos=0.55] {sosa:observes $\blacktriangledown$}
  (ObservableProperty);


  % Questions

  \draw[ssnr] (FeatureOfInterest) to[bend right=10]
    node[ssnl,above] {sosa:hasProperty $\blacktriangleright$}
    node[ssnl,below] {$\blacktriangleleft$ sosa:isPropertyOf }
  (ObservableProperty);

  \draw[color=red,rotate=-20] (-0.1459,-5.5667) ellipse (0.2 and 0.6);
  \node[color=red] at (0.3655,-1.2855) {\why};


  \draw[color=red] (0.1816,-0.8565) ellipse (.6 and 0.2);
  \node[color=red] at (-1.5716,-5.3153) {\why};


  \draw[sosar] ($(FeatureOfInterest.north)+(-0.5,0)$) to[bend left=15]
    node[sosal,left] {\why}
  (Actuation.south west);


  \draw[sosar] (7,1) to[bend right=15]
    node[sosal,left] {\why}
  (Procedure);


  \draw[sosar] ($(ObservableProperty.north)+(0.5,0)$) to[bend right=15]
    node[sosal,left] {\why}
  (Actuator.south east);



  \draw[color=red,rotate=15] (-7.565,2.6538) ellipse (3 and 0.5);
  \node[color=red] at (-6.2512,0.3548) {\why};


  \draw[color=red,rotate=15] (-8.8951,0.5617) ellipse (2 and 0.3);
  \node[color=red] at (-8.329,-2.2745) {\why};



\end{tikzpicture}
\end{document}
